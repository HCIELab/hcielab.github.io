<!DOCTYPE html>
<html>
<head>
	<title>HCI Engineering Group</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<!-- CSAIL ICON -->
	<link rel="CSAIL" href="../../../images/icon/csail.ico" type="image/x-icon" />

	<!-- Bootstrap -->
	<link href="../../../css/bootstrap.css" rel="stylesheet">
	<link href="../../../css/custom-style.css" rel="stylesheet">

	<!-- jQuery -->
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Barlow" rel="stylesheet">

	<!-- Google Analytic -->
	<script type="text/javascript" src="../../js/analytics.js"></script>

	<style>
	.etech-sch-col1 {width:60px; border: 1px solid black;padding:10px;}
	.etech-sch-col2 {width:120px; border: 1px solid black;padding:10px;}
	.etech-sch-col3 {width:450px; border: 1px solid black;padding:10px;}
	.etech-sch-col4 {width:70px; border: 1px solid black;padding:10px;}
  .etech-sch-col5 {width:70px; border: 1px solid black;padding:10px;}
  /*.etech-sch-col6 {width:170px; border: 1px solid black;padding:10px;}*/
  ul {
    padding:0px;padding-left:10px;margin:0px;
  }
	</style>
</head>

<body>
<header class="main_header">
	<!-- to be filled by javascript, see header.html -->
</header>

<section class="main_container">
	<div class="container">
    <div class="row nothing">

      <section class="col-md-8 pull-right main-content">
</br></br></br></br>
        <h4 class="medium.headline"><a href="6810-engineering-interactive-technologies.html">6.810 Engineering Interactive Technologies (fall 2020)</a><br></h>
        <h2 class="headline">Part 2: Connecting Micro-controller to UI</h2>
      
          <hr>

          <!-- Code in: Documents / Processing / SimpleRead --> 
          <!-- Code in: Documents / Arduino / serial-write -->
          <!-- Code in: Documents / Processing / SimpleWrite -->
          <!-- Code in: Documents / Arduino / serial-read -->

In the next weeks, we are going to build a range of different physical user interfaces. Below, you see the basic pipeline we will cover before going into more advanced examples. <br><br>

The pipeline consists of four steps:<br>

<ul>
  <li>Fabricating the Sliders, Dials, and Multi-touch Pad (Printed Electronics)</li>
  <li>Wiring up the Electronics and Performing Signal Processing on the Inputs from the User (Arduino)</li>
  <li><b>Sending the results from the microcontroller to a User Interface (Arduino-Processing connection)</b></li>
  <li>Displaying the Result in a graphical user interface on screen (Processing)</li>
</ul>
<br>

 <h3 class="headline">Reading input from the Microcontroller<br> and Displaying it in Processing</h3>

First, we are going to read some input from our microcontroller and display the resulting action in Processing.<br>
In particular, we are going to wire up a button, and when the button is pressed, we will show this in Processing by coloring the corresponding button in the digital UI.<br><br>

<h4>Wiring Up a Button</h4>

Let's start by wiring up a button.<br>

<img src="images/button-on-breadboard.jpg" width="250px"> <img src="images/button-on-breadboard-schematic.jpg" width="350px"><br><br>

<h4>Create Microcontroller Script that Writes onto Serial Monitor</h4>

Next, we need to create the microcontroller script that reads the input from the button.<br>
When the button is pushed, we want to write a message to the Serial port that indicates the push state.<br>
Our seperate Processing application will then listen to the Serial port and whenever it sees a specific value, it will know if the button is pushed or not.<br><br>

<b>Your task:</b> Write the Arduino script for reading the button input. When the button is pushed, write a 0 to the serial port using Serial.write(0). If the button is unpushed, write a 1 to the serial port using Serial.write(1). You can use any Serial baudrate you like, in our example we will use 9600. <br><br>

<b>Important:</b> Once you confirmed that you button works, make sure you remove all Seriel.println debugging statements you may have used since they will otherwise add noise to the Serial stream the Processing application will listen to.<br><br>

<img src="images/serial-write.png" width="300px">

<h4>Create Processing Script that Listens to Serial Monitor</h4>

Now that we are writing 0 and 1 to the Serial Monitor depending on whether the button is pressed or not pressed, we can write the Processing script that listens to the Serial Monitor and changes its visualization depending on the number read.<br><br>

To do this, you are going to use the Serial library.<br>
<code>import processing.serial.*;</code><br><br>

Next, you need to create a new port by creating an object from this class: <br>
<code>Serial myPort;</code><br><br>

To initialize this object, you need a reference to the current application ('this'), a portname, and the baudrate to which the object should listen. You already know the baudrate (9600) and you can get the portname with this:<br><br>

<code>String portName = Serial.list()[2]; //check which port you use: 0, 1, 2? it helps to verify you are listening to the right port with print(portName);</code><br><br>

Now you can initialize your Serial connection:<br><br>

<code>myPort = new Serial(this, portName, 9600);</code><br><br>

In the draw function, you need to first check if the port is available, and then you can read the value from the port:<br><br>

<code>
int val;  <br>
if ( myPort.available() > 0) {    // If data is available,<br>
    val = myPort.read();         // read it and store it in val<br>
  }<br>
</code><br>

Now you can do something based on the value:<br><br><br>

<code>
if (val == 0) {              // If the serial value is 0,<br>
    fill(0);                   // set fill to black<br>
  } <br>
  else if (val == 1) {                       // If the serial value is not 0,<br>
    fill(255);                 // set fill to light gray<br>
  }<br>
  rect(50, 50, 100, 100);<br>
</code><br>

Run the code and you should get a processing button that lights up black if your physical button is pushed and white if it is not pushed.<br><br>


 <h3 class="headline">Writing Output from Processing<br> and Using it on the Microcontroller</h3>

Let's do it the other way around and write some output from Processing onto the microcontroller.<br>
In our simple example, we will light up an LED when the user clicks a button in the Processing UI.<br>

<h4>Wiring Up an LED</h4>

<img src="images/led-on-breadboard.jpg" width="250px"> <img src="images/led-on-breadboard-schematic.png" width="350px"><br><br>

<h4>Create Microcontroller Script that Reads from Serial Monitor</h4>

This part is very similar to the previous code, just that instead of Serial.write() you are now going to use Serial.read() to determine if the LED should be high or low.<br><br>

<img src="images/serial-read.png" width="300px"><br><br>

Complete the rest of the Arduino script for turning on/off your LED and test it manually by setting val to 0 or 1 manually. If the LED lights up, remove the line again and have it read from the Serial monitor.<br><br>

<h4>Create Processing Script that Writes to Serial Monitor</h4>

Once you uploaded your Arduino code, we are now ready to write a Processing script to write to the serial monitor if the LED should be on or off.<br>
Whenever a button is clicked in the Processing UI, we want to turn on the LED. <br><br>

The setup code is the same as above, but now you are using<br>
<code>myPort.write(0); // 0 or 1 depending on state</code><br><br>

<b>Your task:</b> Complete the Processing script so that when you click on a button, the LED comes on. <br><br>

<b>Important:</b> Note that there is a 3-5 second delay before the LED comes on which is due to the Serial port speed.<br><br>

 <h3 class="headline">Conclusion</h3>

Great, so now we can both read microcontroller input and display it in Processing and also use Processing to control our microcontroller. This will come in handy in the future when we want to build and test more advanced user interfaces.<br><br>







<br>

        <br />
        <br />
        <br />
      </section>

      <aside class="col-md-4 pull-left">
         <br /> <br /> <br /> <br />
<!-- 				 <h4>Pset Steps</h4><br>
				 <ul>
		 			<li><a href="#pset1">pset1 (due Sept. 21, 11.59pm): laser cut and bend the acrylic base</a><br /></li>
		 			<li><a href="#pset2">pset2 (due Oct. 5, 1pm): insert LEDs, add USB connecting and solder everything</a><br /></li>
		 			<li><a href="#pset3">pset3 (due Oct. 19, 1pm): write touch recognition so that you can determine (x,y) location of each finger</a><br /></li>
		 			<li><a href="#pset4">pset4 (due Oct. 26, 1pm): add an application of your choice</a><br /></li>
				</ul>
				<br /> <br /> <br /> <br />
        <img src="../2018-fall-6810/images/multi-touch-pad/iap1.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad/iap2.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad//iap3.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad/iap4.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad/iap5.jpg" width="220px">
 -->



        <!-- Publication -->

        <br><br><br><br><br>

        <!-- Publication -->

<!-- <h4>Side Bar</h4><br>

    <ul>
      <li>Prof. Stefanie Mueller (Instructor)</li>
      <li>Lotta-Gili Blumberg (TA)</li>
      <li>Xin Wen (UTA)</li>
      <li>Loren Maggiore (LA)</li>
      <li>Mark Chounlakone (LA)</li>
    </ul>
 -->
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>

      </aside>

    </div>
  </div>
  </div>
</section>

<div class="container">
	<div class="row">
		<div class="col-md-12 footer" style="text-align: center;">
			<span class="copyright">
			Since 2017 &copy; MIT CSAIL (HCI Engineering group) [redesign by
			<a href="http://punpongsanon.info/" target="_blank" style="text-decoration:none; border-bottom:0px">
			moji
			</a>].
			All Rights Reserved.

			<a href="http://mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
			<img src="../../images/logo/mit.svg" alt="MIT" class="footer-logo" />
			</a>
			<a href="http://csail.mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
			<img src="../../images/logo/csail.svg" alt="CSAIL" class="footer-logo"/>
			</a>
			<a href="http://hci.csail.mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
			<img src="../../images/logo/hci.svg" alt="HCI" class="footer-logo"/>
			</a>
			</span>
		</div>
	</div>
</div>

<!-- Bootstrap -->
<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
<!-- header -->
<script type="text/javascript" src="../../js/headerstrap-for-subpage.js"></script>

</body>
</html>
