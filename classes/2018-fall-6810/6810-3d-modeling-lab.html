<!DOCTYPE html>
<html>
<head>
  <title>HCI Engineering Group</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <!-- CSAIL ICON -->
  <link rel="CSAIL" href="../../images/icon/csail.ico" type="image/x-icon" />

  <!-- Bootstrap -->
  <link href="../../css/bootstrap.css" rel="stylesheet">
  <link href="../../css/custom-style.css" rel="stylesheet">

  <!-- jQuery -->
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Barlow" rel="stylesheet">

  <!-- Google Analytic -->
  <script type="text/javascript" src="../../js/analytics.js"></script>

  <style>
  .etech-sch-col1 {width:60px; border: 1px solid black;padding:10px;}
  .etech-sch-col2 {width:120px; border: 1px solid black;padding:10px;}
  .etech-sch-col3 {width:450px; border: 1px solid black;padding:10px;}
  .etech-sch-col4 {width:70px; border: 1px solid black;padding:10px;}
  .etech-sch-col5 {width:70px; border: 1px solid black;padding:10px;}
  /*.etech-sch-col6 {width:170px; border: 1px solid black;padding:10px;}*/
  ul {
    padding:0px;padding-left:10px;margin:0px;
  }
  </style>
</head>

<body>
<header class="main_header">
  <!-- to be filled by javascript, see header.html -->
</header>

<section class="main_container">
  <div class="container">
    <div class="row nothing">

      <section class="col-md-8 pull-right main-content">
</br></br></br></br>
        <h4 class="medium.headline"><a href="6810-engineering-interactive-technologies.html">6.810 Engineering Interactive Technologies (fall 2018)</a><br></h>
        <h2 class="headline">3D Modeling Lab (Rhino3D, Grasshopper and Firefly) </h2>

  <!-- <img src="images/laser-cutting/laser-cutter.png" width="183px" /> <img src="images/laser-cutting/laser-cutter-cutting.png" width="250px" /> -->
          <br>
          <hr>

<span style="color:gray">Rhino, Grasshopper and Firefly installation instructions for Windows PC are at the bottom of this tutorial. While Rhino and Grasshopper versions are available for Mac, Firefly plugin is not. If you wish to install these programs on your personal laptops, follow the instructions provided at the bottom. You will also need to have installed Arduino IDE for this tutorial. </span> <br><br>

We think the entire tutorial can be done in 60-70 minutes, but if you need longer, upload 3 is only due next friday in case you get stuck. <br><br>

<h3 span style="color:red">End of class: Upload 1 (Deadline: Oct 19, 2.30pm)</a></h3>
<a style="color:black" href="https://learning-modules.mit.edu/gradebook/index.html?uuid=/course/6/fa18/6.810#assignments/39869546">
  Once you complete Task 1 in this tutorial, take screenshots of your your 3D candle and upload it to Gradebook 
</a> <br> 
<br>

<img src="images/3dmodeling/upload_1.png" width="360px" /><br><br>


<h3 span style="color:red">End of class: Upload 2 (Deadline: Oct 19, 2.30pm)</a></h3>
<a style="color:black" href="https://learning-modules.mit.edu/gradebook/index.html?uuid=/course/6/fa18/6.810#assignments/39869626">
  Once you complete Task 2 in this tutorial, make a (i) video of the parametric candle (ii) .gh file of your grasshopper visual code along with (iii) screenshots of your script to Gradebook</a> <br> 
<br>

<img src="images/3dmodeling/upload_2.png" width="360px" /> <br>
<video width="360"  controls><source src="images/3dmodeling/upload_2.mp4" type="video/mp4"></video><br><br>


<h3 span style="color:red">Next Week: Upload 3 (Deadline: Oct 24, 1 pm)</a></h3>
<a style="color:black" href="https://learning-modules.mit.edu/gradebook/index.html?uuid=/course/6/fa18/6.810#assignments/39869694">
  Once you complete Task 3,4 and 5 in this tutorial, make a (i) video of the virtual parametric candle changing flame based on wind sensor, and add (ii) .gh file of your grasshopper visual code along with (iii) final .STL file of your exported 3D model and (iv) screenshots of your script to Gradebook</a> <br> 
<br>

<img src="images/3dmodeling/upload_3.png" width="640px" /><br><br>

<h3>Goal:</h3>
We will learn to interface between digital 3D modeling environments and physical interfaces. We are going to connect the arduino wind sensor+led circuit (that you built a few weeks ago) with the digital 3D modeling software Rhino3D and its plugins (Grasshopper and Firefly). 

There are many advantages of the digital-physical interfacing:
<ul>
  <li> Real-world sensor data can be used for controlling 3D models in the virtual world
  <li> Virtual models can be used to control or actuate physical interfaces in the real world    
</ul>
<br>

(Note: There are multiple resources listed at the end of this tutorial for more information on 3D parametric modeling using Rhino, Grasshopper and other plugins.)

<br><br>

<span style="color:red">
  Before we start, check if you have all your components of your original wind sensor + LED circuit work correctly. 
  </span><br>

Now let's forget the circuit for a bit and dive into the digital world.<br> 
<h3>Background:</h3>
 While there are multiple 3D modeling softwares available (like Solidworks, OnShape, AutoCAD, Sketchup), we will be using Rhino3D for our lab. It is very easy to learn, intuitive to use and has over 100 plugins (together called Rhino-zoo! ). The applications vary from architecture design, to FEM analysis, to Neural networks for design optimization etc. In particular, the popularity of Rhino3D stems from the plugin called <a href="https://www.rhino3d.com/6/new/grasshopper">grasshopper</a> which allows for parametric visual programming (as you will learn today). We will also be using <a href="http://www.fireflyexperiments.com/">Firefly</a> (which is a plugin for grasshopper), which allows the parameters of design to be controlled by arduino inputs/outputs. <br><br>

In short, we use:<br>
<ul>
  <li><a href="https://www.rhino3d.com/">Rhino3D </a>: for basic 3D modeling<image>
  <li><a href="https://www.grasshopper3d.com/">Grasshopper </a>: for parametric 3D modeling <gif>
    <li><a href="http://www.fireflyexperiments.com/">Firefly </a>: for interfacing with arduino input/outputs <gif/movie>
</ul><br>
<img src="images/3dmodeling/rhino-gh.png" width="750px" /><br><br>


<h3>Here's what we will design and build today:</h3>

<ul>
  <li>Task 1: First familiarize yourself with Rhino3D and 3D model a candle manually using regualar 3D modeling tools.</li>
  <li>Task 2: Familiarize yourself with the Grasshopper plugin and design a parametric candle using visual programming that can change height and diameter and flame size.
  <li>Task 3: Interface with the Firely plugin and control the flame of the parametic candle using the wind sensor (so when your LED turns off, the virtual flame also turns off)
  <li>Task 4: Change the parameters of the candle design and export STL file for 3D printing</li>
  <li>Task 5: (Optional): Download a candle model from free open source CAD database and control that digital candle using the wind sensor.</li>

</ul>
<br>

<h3>Task 1: Familiarizing with Rhino3D and modeling candle (20-25 minutes) </h3><br>

This is the hardest task since 3D modeling is pretty complex, please hang in there it will get easier later :)!<br>
If all the plugin installations are setup properly  on your computer, you should be able to open Rhino6 using the icon on the desktop on the EDS lab computers.<br> <br>

It opens 4 viewports and looks like any typical CAD software.<br>
We will 3D model a simple candle to familiarize us with the interface.<br>

<span style="color:red">All steps are also illustrated in the video below the text bullets.</span>
<ul>
    <li>Set all your viewports to "shaded" ("ghosted" also works). </li>
    <li>Zoom in and zoom out is using scroll of mouse. Pan is by pressing the center mouse button.</li>
    <li>Set the units of your file to 'inches' (you can also use centimeters or millimeters if you feel more comfortable with this). To do this, type “units” in the command line and then select the units you want to work with.</li>
    <li>3D model the candle base: Refer the video for 3D modeling of the candle base. The commands we will use are: circle, extrusion, cap</li>
    <li>3D model the flame: Commands to use are : eliipse, line, revolve</li>
    <li>Note: You can either model using commands in the command window (top white bar) or using the toolbars on left
    <li>Now that you have the candle modelled, we will use some transformations to change the shape of the candle using: Scale, Scale1D, Scale2D and also change the color properties. </li>
    <li>Rhino3D UI tips: </li>
    	<ul><li>Switch "Osnap" ON at the bottom toolbar and make sure the box for "Center" is checked. This will help you snap on the center of the circle while 3D modeling.</li>
        <li>You can maximize a viewport by double clocking on the viewport name</li>
    		</ul>
		</ul>

<video width="750"  controls>
  <source src="images/3dmodeling/candle3Dmodeling2.mp4" type="video/mp4"></video>
 <br><br>

<span style="color: red"> <a style="color:red" href="https://learning-modules.mit.edu/gradebook/index.html?uuid=/course/6/fa18/6.810#assignments/39869546">Upload 1: Once you have modeled the candle, save the file from File -> SaveAs and upload it to your gradebook with a screenshot (you can also use your cellphone and take a snap of the display).</a> </span><br><br>

<h3>Task 2: Familiarizing with Grasshopper and modeling "parametric" candle (40-50 minutes) </h3><br>
Open a new file (File -> New -> then click the 'No Template' button) and type “grasshopper” in the command line and it will open a new window.<br><br>

 This new window is your visual programming environment - like a visual script. If you create a 3D model (lets say a sphere, the 3D model will show up in the Rhino3D window, but you will be able to manipulate it realtime through grasshopper code, as we will see in next steps. <br><br>

You also have sliders and sequence generators that you can use to control parameters (hence the name “parametric” design) <br><br>

Let's try a simple addition script, first with discrete numbers and then with sliders (again see the video below). <br><br>

<li>GH UI tips: 
    	<ul><li>If you double click on the canvas, you can search a component by typing 
    		<li>The preview of grasshopper can be switched on and off by clicking the center button on mouse and clicking the "preview off" icon
    		<li>You can enable/disable a component execution by clicking the center button on mouse and clicking the "enable/disable" icon
    	</ul>

<video width="750"  controls>
  <source src="images/3dmodeling/addition.mp4" type="video/mp4"></video>
    <br><br>

Now you can use the output of the addition as the input parameter for 3D sphere 
<br><br>

<video width="750"  controls>
  <source src="images/3dmodeling/sphere.mp4" type="video/mp4"></video>
    <br><br>

Now that we know how to make parametric forms, we will make a parametric candle. You can start with a new grasshopper file. We will follow the same design steps that we did for Rhino3D candle, except this time through grasshopper. First, lets start with the candle base. <br><br>

<video width="750"  controls>
  <source src="images/3dmodeling/candlebase.mp4" type="video/mp4"></video>
    <br><br>

Next, we will make the candle flame. This part is a little tricky because the location of the flame depends on the top of the candle (which keeps changing). So, we will have to first locate the centre of the top of the candle face and then add the vertical ellipsoidal geometry. Once we have modeled this, we will change the color, scale and other properties of the flame. <br><br>

<video width="750"  controls>
  <source src="images/3dmodeling/candleflame.mp4" type="video/mp4"></video>
    <br><br>

<span style="color: red"> <a style="color:red" href="https://learning-modules.mit.edu/gradebook/index.html?uuid=/course/6/fa18/6.810#assignments/39869626">Upload 2: Once you have modeled the parametric candle, save the file and upload it to your gradebook along with short video and screenshots. Again use your phone to make a quick capture if you don't have a screen cast software. </a></span><br><br>


<h3>Task 3: Interfacing Arduino with Firefly to blow out the digital candle with the physical wind sensor (20-30 minutes) </h3><br>
Now we will start the most fun part. But before we start controlling our arduino board with Firefly, we need to first upload a arduino script that will allow this communication. Follow the next steps carefully to avoid debugging errors. <br><br>

<li> Step 1: Download this Arduino .ino file: <a href="https://drive.google.com/open?id=1rniLeJybBRAkoNDu_tWF_Ia5wzupVhQR ">Firefly_Firmata.ino</a>, then open it in the Arduino IDE, then click compile and upload it to the board. <span style="color: red"> Make sure you have selected your board to be Arduino Nano and your port to the right COM port before uploading. </span>
<br><br>
<img src="images/3dmodeling/firmata.png" width="750px" /><br><br>

<li> Step 2: <span style="color: red"> If the upload was successful, make sure to close the Arduino IDE completely otherwise your port will be busy communicating with Arduino and Rhino's Firefly will not be able to get/send data to microcontroller board. </span>
<br><br>

<li> Step 3 (see video for step-by-step description): Go back to Rhino/Grasshopper and go to Firefly toolbar and establish the connection with arduino. Check open ports → Open port → select COM port → match your BaudRate (same as in arduino IDE) → and then toggle true. If it says “Hooray, the …” then you have successfully established connection. If you have more than one port displayed, you can select the one that matches your arduino IDE from the list by using "list item" component and then selecting the index(i) of the COM port you want from the list. Now toggle “False”. <span style="color: blue"> Always remember to stop communication with firefly when switching to arduino and vice versa. </span>
<br><br>

<video width="750"  controls>
  <source src="images/3dmodeling/firefly_port.mp4" type="video/mp4"></video>
    <br><br>

<li> Step 4: While you can write up the exact same script you wrote last week in firefly and upload through Firefly, for now we will use Arduino itself. So open Arduino IDE again, and upload this new <a href="https://drive.google.com/open?id=1Oft5W5aVzO5K9xCtmZeRY01j-0QCmFuU ">candlescript</a>. Note: This script is same as before, except for one change. We will also print 0/1 based on whether the LED is on or off. We will be printing in serialport (not serial monitor). This will allow us to read the values 0/1 in Firefly and we can use it for changing 3D model parametrically (Flame will be yellow if printed value is 1 and disappear if printed value is 0). Once you upload it, open the serial plotter and check if the values are being plotted (switch on and blow of your led a couple of times)
<br><br>

<li> Step 5: Now close arduino (to stop communication with port). Go back to Firefly.
<br><br>

<li> Step 6: Select SerialRead (this component can read the data from serial plotter). Check whether the same values of 0/1 are being printed in Firefly as you light/blowoff off the candle using the wind-sensor. If the values are printing, you are now ready to use these values to change the color of the fame or the flame radius. For color change, we will make a list of two colors (0)-white and (1)-yellow. If the plotter prints 0, the color chosen from the list will be (0)-white and if the plotter prints 1, the color chosen will be (1)-yellow. For radius change, we will replace the radius slider with the values coming from serial plotter in the same way by making a list of two integers. Note: this video doesn't capture when the LED switches on and off on the microcontroller. 

<br><br>

<video width="750"  controls>
  <source src="images/3dmodeling/firefly_candle.mp4" type="video/mp4"></video>
<br><br>

Step 7: Now you can change any parameter of the candle based on input from the serial plotter such as radius of the candle, height, color, etc. Play around a little and make your own versions of candle adapting to the wind sensor.

<span style="color:red">
Upload 3. Video of the color and flame going on/off based on input from wind sensor </span><br>
Optional (you can also change the size/scale of the candle using the input from the wind sensor)<br>

<h3>Task 4: Exporting .STL file from Grasshopper/Rhino3D.</h3>
Because grasshopper is only simulating the visualization, your model doesn't truly exist in the Rhino UI until you "bake" a version you want permanent. Here is how you bake a certain version of the model and export it into .STL file for 3D printing. To bake a component from grasshopper, you Right click onthe component in gh and click "Bake" and select the layer you want the geometry to be baked in. For exporting the .STL file, go to Rhino, now select the geometry you want to export, go to File --> Export Selected.




<video width="750"  controls>
  <source src="images/3dmodeling/Rhino-gh-export.mp4" type="video/mp4"></video>
<br><br>
<span style="color:red">
 Upload 4: Export your desired version of the parametric candle in .STL format and upload in the gradebook.
</span><br>

<h3>Task 5: <span style="color:blue">(Optional) </span>  Modifying 3D models from online sources </h3>
You can also modify existing 3D models in grasshopper to suit your preferences. Download a model from thingiverse or any other source, and change it in grasshopper and make a version you would want to 3D print. (Hint: to modify an exsiting geometry through gh, you can reference it by selecting "Geometry" --> Right click --> "Select One Geometry" --> Clock on the geometry in the Rhino UI)
<span style="color:red"> <br><br>

Upload 5: Upload a new version of candle. 
</span><br>
----------------------------------------------------------------------------------------------------------------

<br><br>

 
Installation Instructions for Windows:
<li>Download Rhino 6 from <a href = "" >Rhino3D website.</a> A 90 trial version will also work.</li>
<li>Once installed, open Rhino3D and type "Grasshopper" in the command window (top white bar). Check if it opens correctly</li>
<li>In Grasshopper, got to File --> Special Folders --> Components Folder</li>
<li>Copy all the files from <a href="https://drive.google.com/drive/folders/18DNAEIJhMYDjQKurP7WTbm7VIxo1UHc6?usp=drive_open">this location</a> into the Components Folder (These are Firefly installation files)</li>
<li>Restart Rhino, reopen Grasshopper and a new toolbar called Firefly should appear in Grasshopper </li>


 <br>

 
Additional Resources for learning Rhino3D, Grasshopper and other plugins of the Rhino zoo. <br>

<li><a href="https://www.youtube.com/watch?v=yPgMccdh8QU ">Rhino Tutorials</a>
<li><a href="https://www.grasshopper3d.com/page/tutorials-1 ">Grasshopper Resources</a>
<li><a href="https://www.youtube.com/watch?v=2bAyWdHPXas ">Grasshopper Tutorials</a>
<li><a href="http://www.fireflyexperiments.com/resources/ ">Firefly examples</a>
<li><a href="https://www.food4rhino.com/ ">Food4Rhino / Rhino Zoo</a>



















    <br><br><br>
      </section>

      <aside class="col-md-4 pull-left">

        <!-- Publication -->

        <br><br><br><br><br>


<!-- <h4>Side Bar</h4><br>

    <ul>
      <li>Prof. Stefanie Mueller (Instructor)</li>
      <li>Lotta-Gili Blumberg (TA)</li>
      <li>Xin Wen (UTA)</li>
      <li>Loren Maggiore (LA)</li>
      <li>Mark Chounlakone (LA)</li>
    </ul>
 -->
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>

      </aside>

    </div>
  </div>
  </div>
</section>

<div class="container">
  <div class="row">
    <div class="col-md-12 footer" style="text-align: center;">
      <span class="copyright">
      Since 2017 &copy; MIT CSAIL (HCI Engineering group) [redesign by
      <a href="http://punpongsanon.info/" target="_blank" style="text-decoration:none; border-bottom:0px">
      moji
      </a>].
      All Rights Reserved.

      <a href="http://mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
      <img src="../../images/logo/mit.svg" alt="MIT" class="footer-logo" />
      </a>
      <a href="http://csail.mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
      <img src="../../images/logo/csail.svg" alt="CSAIL" class="footer-logo"/>
      </a>
      <a href="http://hci.csail.mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
      <img src="../../images/logo/hci.svg" alt="HCI" class="footer-logo"/>
      </a>
      </span>
    </div>
  </div>
</div>

<!-- Bootstrap -->
<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
<!-- header -->
<script type="text/javascript" src="../../js/headerstrap-for-subpage.js"></script>

</body>
</html>
