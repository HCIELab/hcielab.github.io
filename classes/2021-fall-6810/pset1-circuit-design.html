<!DOCTYPE html>
<html>
<head>
	<title>HCI Engineering Group</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<!-- CSAIL ICON -->
	<link rel="CSAIL" href="../../images/icon/csail.ico" type="image/x-icon" />

	<!-- Bootstrap -->
	<link href="../../css/bootstrap.css" rel="stylesheet">
	<link href="../../css/custom-style.css" rel="stylesheet">

	<!-- jQuery -->
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Barlow" rel="stylesheet">

	<!-- Google Analytic -->
	<script type="text/javascript" src="../../js/analytics.js"></script>

	<style>
	.etech-sch-col1 {width:60px; border: 1px solid black;padding:10px;}
	.etech-sch-col2 {width:120px; border: 1px solid black;padding:10px;}
	.etech-sch-col3 {width:450px; border: 1px solid black;padding:10px;}
	.etech-sch-col4 {width:70px; border: 1px solid black;padding:10px;}
  .etech-sch-col5 {width:70px; border: 1px solid black;padding:10px;}
  /*.etech-sch-col6 {width:170px; border: 1px solid black;padding:10px;}*/
  ul {
    padding:0px;padding-left:10px;margin:0px;
  }
	</style>
</head>

<body>
<header class="main_header">
	<!-- to be filled by javascript, see header.html -->
</header>

<section class="main_container">
	<div class="container">
    <div class="row nothing">

      <section class="col-md-8 pull-right main-content">
</br></br></br></br>
        <h4 class="medium.headline"><a href="6810-engineering-interactive-technologies.html">6.810 Engineering Interactive Technologies (fall 2020)</a><br></h>
        <h2 class="headline">Problem Set Series: Multi-Touch Pad</h2>


<img src="images/pset-overall2.png" width="600px">

          <hr>

<h2 class="headline">Problem Set 1</h2>

In the first part of the problem set, you are going to do the following steps:
<ul>
	<li>(1) Create Processing User Interface for Generating Fabrication Files</li>
	<li>(2) Inkjet Print Top and Bottom Electrode Layers</li>
	<li>(3) Assemble Top and Bottom Electrode Layers</li>
	<li>(4) Connect Top and Bottom Electrode Layers to FCP connectors</li>
	<li>(5) Build Multi-Touch Sensing Circuit</li>
</ul>


<h3>Check before you start: Do you have all the hardware?</h3>

Before you get started, check if you have all of the following in your bag:<br>

<ul>
	<li>ESP32 microcontroller, breadboard, and wires</li>
	<li>8 x 100Kohm resistors (one for each receiver pin)</li>
	<li>one multiplexer</li>
	<li>two FPC connectors</li>
</ul><br>

In addition, the following items will be provided when you come in for printing and assembling the multitouch pad:<br>

<ul>
	<li>two transparent sheets for conductive inkjet printing of the top and bottom electrodes</li>
	<li>tattoo transfer paper that acts as a thin layer of glue to attach the top and bottom electrode sheets to each other</li>
	<li>one transparent sheets to cover up the top electrodes</li>
</ul><br>

<img src="images/pset1/components-explained.png" width="650px"><br><br>

<!-- <img src="images/pset1-transparent-sheets.jpg" width="300px"> -->


<h3>(1) Processing User Interface for <br>Generating Fabrication Files</h3>

In the first part of this problem set, you will write a user interface in Processing that will automatically generate the fabrication files for making multi-touch pads of different dimensions. In particular, a user will be able to input parameters, such as the number of electrodes of the multi-touch pad and then automatically receive the matching fabrication files, i.e. 2D drawings of the required circuits in .pdf file format that the user can then send to their 2D printer for conductive inkjet printing. You will implement this interface in Processing from scratch.<br><br>

We will be using the classical two-layered diamond pattern that is commonly used for mutual-capacitive touch sensing. <br>
As explained in lecture, this means that your multi-touch pad has two layers that are printed separately.<br>
One layer contains the rows of electrodes, the other layer contains the columns.<br>
Each row/column consists of multiple electrodes and has a single wire at the end.<br>
Once both sheets are printed, you layer them on top of each other (with a bonding & isolation layer in between) to build the final circuit.<br><br>

<img src="images/pset1/multitouch-overview.png" width="250px">
<img src="images/pset1-multitouch-pad-explanation2.png" width="450px"><br><br>

<b>Required User Interface Functionality</b><br>

In the user interface, the user should be able to select:<br>


<ul>
	<li>the desired number of electrodes in x-direction (default value: 10 electrodes)</li>
	<li>the desired number of electrodes in y-direction (default value: 10 electrodes)</li>
	<li>the edge length of the electrodes (diamond shape) in mm (default value: 6mm)</li>
	<!-- <li>the spacing between adjacent electrodes in mm (default value: 1mm)</li>
	<li>the spacing between non-connected electrodes, i.e. rows and columns, in mm (default value: 0.5mm)</li>
	<li>the thickness of the wires in mm (default value: 0.35mm)</li>
	<li>the spacing of wires on the FPC connector in mm <span style="color:red">(to find the correct value, look at the data sheet of the FPC connector)</span></li> -->
</ul>
<br>

Other parameters that you need to set in your code but don't have to display in the UI, are: <br>
<!--  for the design (you don't have to display them in the UI, but please do think of good reasons for them, you can start from <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/FAQs%20-%20Sensor%20Design%20Guidelines.pdf">here</a>): <br> -->
<ul> 
	<li>the spacing between adjacent electrodes in mm (default value: 1mm)</li>
	<li>the spacing between non-connected electrodes, i.e. rows and columns, in mm (default value: 1mm)</li>
	<li>the thickness of the wires inside of multi-touch pad that connect electrodes, in mm (default value: 0.3mm)</li>
	<li>the thickness of the wires outside of multi-touch pad that connect to FPC connectors, in mm (default value: 0.5mm)</li>
	<li>the spacing of wires on the FPC connector in mm (we are using the 1mm in FPC spacing, notice that the board has two sides and could also be used for 0.5mm if the 0.5mm connector was soldered on the other side. For more details, please look at the data sheet of the FPC connector <a href="https://datasheet.octopart.com/FH12-10%284%29SA-1SH%2855%29-Hirose-datasheet-8324494.pdf">here</a>)</li>
</ul>
<br>

<img src="images/pset1/fpc-spacing_new.png" width="350px">
<img src="images/pset1/multitouch-measurements.png" width="350px"><br><br>


The user interface should only allow the user to select only reasonable numbers using the input elements:<br>

<ul>
	<li>for each input field listed above, think about what is a reasonable lower and upper bound (i.e. min/max values) given the hardware you have available for the pset</li>
	<li>write a short explanation why you picked the lower/upper bounds for each field and <a href="https://forms.gle/XmwrnYpiivpRzv7J8">submit it using this google form</a> (before you fill out the google form, you may want to read the rest of pset1 to understand more about the hardware you have available)</li>
	<li>implement the lower/upper bounds in your user interface, i.e. the user should either not be able to select values outside the lower/upper bounds (i.e. you only offer a selection of valid numbers) or if your UI allows to enter any value even invalid ones, then your user interface needs to show the user a warning that the value is invalid and reset to the last valid value</li>
</ul>
<br>

Finally, the user interface should have a preview and export function:<br>

<ul>
	<li>one button to switch between the design's top and bottom layer view, i.e. clicking the button should either show the top layer or the bottom layer so the layers can be looked at individually</li>
	<li>one save button, which when clicked saves the generated electrodes into two .pdf files (called bottom-electrodes.pdf and top-electrodes.pdf), one for the rows of electrodes (bottom sheet) and one for the columns (top sheet)</li>
	<li>make sure the exported files have all settings correctly set for conductive inkjet printing (if you don't remember, go back to Lab1) </li>
</ul>
<br>

<img src="images/pset1-Processing-UI_1.png" width="500px"><br><br>

The switch top / bottom view function should look like something similar to the following: <br>
<img src="images/pset1/switch-view.png" width="700px"><br><br>


<b>Setting the Processing window to the right resolution for printing</b><br>
Since the multi-touch pad design is printed in <b>millimeter</b> but Processing handles everything in <b>pixel</b>, you first need to figure out a conversion factor between pixel and millimeter to determine the Processing window size. <br><br>

Note that Processing uses a fixed dots per inch measurement.<br>
On <b>Windows,</b> you are most likely to encounter a 96 dpi resolution.<br>
On <b>Mac,</b> you are also most likely to encounter a 96dpi resolution but it may also be 72dpi. <a href="https://en.wikipedia.org/wiki/Dots_per_inch">Wikipedia</a> thinks it is 72dpi, however, according to our own tests on Mac, it was 96dpi, i.e. the same as on Windows.<br>
(Note that the resolution of the Processing sketch window is different from the screen resolution pixel per inch, which usually are around a couple hundred nowadays, this is set by the operating system and mainly used for programs heavy on typography like Microsoft Word).<br><br>

If you are unsure about the right resolution, you can do the following test:<br>
Create a window in Processing of any size and draw a rectangle into the window using a fixed pixel size (e.g. rect(96,96) = 96 x 96 pixels).<br>
Export the square using your implemented .pdf export function and print it out with a normal inkjet printer. While printing make sure you don't scale the image and instead print it with the <b>"Print Entire Image"</b> setting which keeps it at its exported size.<br>
Next, measure the output with a ruler and determine how many inch it is (e.g., let's say it was 1 inch). <br>
Finally, you can calcuate Processing's dpi by calculating the pixel to inch conversion factor based on this, which in our case is 96dots/1 inch = 96dpi.<br>
Since our inputs are in mm, you still need to convert the dpi to dots per mm. For this, simply divide by how many millimeters are one inch (1 inch = 25.4mm). Thus, we will have 96dpi / 25.4mm = 3.78 dots per mm.<br>
So if you draw a rectangle of 100 pixel it will be 100pixel / 3.78 dots per mm = 26.46mm.<br><br> 

<img src="images/pset1-printing-setting.png" width="600px"> <br><br>

<b>Drawing the Top and Bottom Electrodes and Wires</b><br>

You may find it helpful to look at the following Processing classes to draw the top and bottom electrodes and wires:<br>

<ul>
	<li><a href="https://processing.org/reference/PGraphics.html">PGraphics</a></li>
	<li><a href="https://processing.org/reference/PImage.html">PImage</a></li>
</ul>
<br>

<b>Creating User Interface Input Elements</b><br>

For the UI elements, we do not use an external library and instead use a simple trick:<br>
We draw the UI elements as regular graphic shapes (e.g. rectangles), add a text where needed to display numbers, and then use mouse-click and drag events to update the UI elements.<br>

<ul>
	<li><a href="https://processing.org/reference/rect_.html">Rect</a></li>
	<li><a href="https://processing.org/tutorials/text/">Text and Fonts Tutorial</a></li>
	
</ul>
<br>

<b>Testing your Program</b><br>

When you are done, make sure you test your user interface by exporting several different multi-touch pad sizes, e.g. 4x10, 12x6, 5x5.
If you are unsure if everything has the right dimension, use a regular color printer to print out your design and measure it with a ruler.<br>

<br>

<h3>Upload your Code and Design Files, Show Hardware to TA</h3>

For grading, please upload the following to your google drive student folder:<br>

<ul>
	<li>the .pde file of your Processing program</li>
	<li>the two .pdf files you used for conductive inkjet printing</li>
	<li>3-5 photos showing your assembled circuit from different perspectives (include top view + side views)</li>
	<!-- <li><span style="color:red">bring your assembled multi-touch pad to your spray session</span></li> -->
</ul>


<h3>Grading</h3>

We will give 25 pts in total:
<ul>
	<li>does the Processing UI have input elements that correctly set the number of electrodes in x-direction, the number of electrodes in y-direction, and the edge length of the electrodes, or are these values hardcoded in the code? (5 pts)</li>
	<li>does the Processing UI have lower and upper bounds for each input field? are the selected lower and upper bounds well reasoned based on what makes sense given the hardware parts you have available for the pset, the sensing principle we use, and given that a human is touching the multi-touch pad? (5 pts)</li>
	<li>does the Processing UI export function export a drawing in the correct dimensions into two seperate .pdf files that are named correctly and that have the correct settings for conductive inkjet printing? are the toggle functions for showing/hiding layers implemented? (5 pts)</li>
	<li>did you finish assembling your multi-touch pad, i.e. did you inkjet print both the top and bottom electrode layer, glued them together, and connected the FPC chips? (5 pts)</li>
	<li>did you correctly build the multi-touch sensing circuit using the multiplexer, resistors and ESP? (5 pts)</li>
</ul>


        <br />
      </section>

      <aside class="col-md-4 pull-left">
         <br /> <br /> <br /> <br />
<!-- 				 <h4>Pset Steps</h4><br>
				 <ul>
		 			<li><a href="#pset1">pset1 (due Sept. 21, 11.59pm): laser cut and bend the acrylic base</a><br /></li>
		 			<li><a href="#pset2">pset2 (due Oct. 5, 1pm): insert LEDs, add USB connecting and solder everything</a><br /></li>
		 			<li><a href="#pset3">pset3 (due Oct. 19, 1pm): write touch recognition so that you can determine (x,y) location of each finger</a><br /></li>
		 			<li><a href="#pset4">pset4 (due Oct. 26, 1pm): add an application of your choice</a><br /></li>
				</ul>
				<br /> <br /> <br /> <br />
        <img src="../2018-fall-6810/images/multi-touch-pad/iap1.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad/iap2.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad//iap3.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad/iap4.jpg" width="220px">

		<img src="../2018-fall-6810/images/multi-touch-pad/iap5.jpg" width="220px">
 -->



        <!-- Publication -->

        <br><br><br><br><br>

        <!-- Publication -->

<!-- <h4>Side Bar</h4><br>

    <ul>
      <li>Prof. Stefanie Mueller (Instructor)</li>
      <li>Lotta-Gili Blumberg (TA)</li>
      <li>Xin Wen (UTA)</li>
      <li>Loren Maggiore (LA)</li>
      <li>Mark Chounlakone (LA)</li>
    </ul>
 -->
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>

      </aside>

    </div>
  </div>
  </div>
</section>

<div class="container">
	<div class="row">
		<div class="col-md-12 footer" style="text-align: center;">
			<span class="copyright">
			Since 2017 &copy; MIT CSAIL (HCI Engineering group) [redesign by
			<a href="http://punpongsanon.info/" target="_blank" style="text-decoration:none; border-bottom:0px">
			moji
			</a>].
			All Rights Reserved.

			<a href="http://mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
			<img src="../../images/logo/mit.svg" alt="MIT" class="footer-logo" />
			</a>
			<a href="http://csail.mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
			<img src="../../images/logo/csail.svg" alt="CSAIL" class="footer-logo"/>
			</a>
			<a href="http://hci.csail.mit.edu/" target="_blank" style="text-decoration:none; border-bottom:0px">
			<img src="../../images/logo/hci.svg" alt="HCI" class="footer-logo"/>
			</a>
			</span>
		</div>
	</div>
</div>

<!-- Bootstrap -->
<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
<!-- header -->
<script type="text/javascript" src="../../js/headerstrap-for-subpage.js"></script>

</body>
</html>
